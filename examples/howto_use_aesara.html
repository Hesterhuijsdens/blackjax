
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Use with Aesara models</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Use with Numpyro models" href="howto_use_numpyro.html" />
    <link rel="prev" title="Welcome to Blackjax!" href="../index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/blackjax.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PPL INTEGRATION
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Aesara
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="howto_use_numpyro.html">
   Numpyro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="howto_use_oryx.html">
   Oryx
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="howto_use_pymc.html">
   PyMC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="howto_use_tfp.html">
   Tensorflow-Probability
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  HOW TO
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="howto_sample_multiple_chains.html">
   Sample with multiple chains?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="howto_custom_gradients.html">
   Use custom gradients?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="howto_other_frameworks.html">
   Use non-JAX log-prob functions?
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LEARN BY EXAMPLE
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../examples.html">
   Examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Introduction.html">
     A Quick Introduction to Blackjax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="LogisticRegression.html">
     Bayesian Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="LogisticRegressionWithLatentGaussianSampler.html">
     Bayesian Logistic Regression With Latent Gaussian Sampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="SparseLogisticRegression.html">
     Sparse logistic regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="TemperedSMC.html">
     Use Tempered SMC to Improve Exploration of MCMC Methods.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="PeriodicOrbitalMCMC.html">
     Periodic Orbital MCMC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="GP_EllipticalSliceSampler.html">
     Gaussian Regression with the Elliptical Slice Sampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="GP_Marginal.html">
     Bayesian Regression With Latent Gaussian Sampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="change_of_variable_hmc.html">
     Change of Variable in HMC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Pathfinder.html">
     Pathfinder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="RegimeSwitchingModel.html">
     Regime switching Hidden Markov model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="HierarchicalBNN.html">
     Hierarchical Bayesian Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="SGMCMC.html">
     MNIST Digit Recognition With a 3-Layer Perceptron
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="contour_sgld.html">
     Contour stochastic gradient Langevin dynamics
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mcmc.html">
   MCMC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sgmcmc.html">
   Stochastic gradient MCMC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../smc.html">
   Sequential Monte Carlo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../vi.html">
   Variational Inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../adaptation.html">
   Adaptation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../diagnostics.html">
   Diagnostics
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/blackjax-devs/blackjax"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Use with Aesara models</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="use-with-aesara-models">
<h1>Use with Aesara models<a class="headerlink" href="#use-with-aesara-models" title="Permalink to this headline">#</a></h1>
<p>Blackjax accepts any log-probability function as long as it is compatible with <code class="docutils literal notranslate"><span class="pre">jax.jit</span></code>, <code class="docutils literal notranslate"><span class="pre">jax.grad</span></code> (for gradient-based samplers) and <code class="docutils literal notranslate"><span class="pre">jax.vmap</span></code>. In this example we will show ho we can use <a class="reference external" href="https://github.com/aesara-devs/aesara">Aesara</a> as a modeling language and Blackjax as an inference library.</p>
<div class="admonition-before-you-start admonition">
<p class="admonition-title">Before you start</p>
<p>You will need <a class="reference external" href="https://github.com/aesara-devs/aesara">Aesara</a> and <a class="reference external" href="https://github.com/aesara-devs/aeppl">AePPL</a> to run this example. Please follow the installation instructions on their respective repository.</p>
</div>
<p>We will implement the following Binomial response model for the rat tumor dataset:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
Y &amp;\sim \operatorname{Binomial}(N, \theta)\\
\theta &amp;\sim \operatorname{Beta}(\alpha, \beta)\\
\alpha, \beta &amp;\sim \frac{1}{(\alpha + \beta)^{2.5}}
\end{align*}\end{split}\]</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># index of array is type of tumor and value shows number of total people tested.</span>
<span class="n">group_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>

<span class="c1"># index of array is type of tumor and value shows number of positve people.</span>
<span class="n">n_of_positives</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="n">n_rat_tumors</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>We implement the generative model in two parts, the improper prior on <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> and then the response model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">aesara</span>
<span class="kn">import</span> <span class="nn">aesara.tensor</span> <span class="k">as</span> <span class="nn">at</span>

<span class="kn">from</span> <span class="nn">aeppl</span> <span class="kn">import</span> <span class="n">joint_logprob</span>

<span class="c1"># improper prior on `a` and `b`.</span>
<span class="n">a_vv</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">b_vv</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">logprior</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">at</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a_vv</span> <span class="o">+</span> <span class="n">b_vv</span><span class="p">)</span>

<span class="c1"># response model</span>
<span class="n">srng</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomStream</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">theta_rv</span> <span class="o">=</span> <span class="n">srng</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a_vv</span><span class="p">,</span> <span class="n">b_vv</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n_rat_tumors</span><span class="p">,))</span>
<span class="n">Y_rv</span> <span class="o">=</span> <span class="n">srng</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">group_size</span><span class="p">,</span> <span class="n">theta_rv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can then easily compile a function that samples from the prior predictive distribution, i.e. returns values of <code class="docutils literal notranslate"><span class="pre">Y_rv</span></code> based on the variables’ prior distribution. Let us make this function depend on the values of <code class="docutils literal notranslate"><span class="pre">a_vv</span></code> and <code class="docutils literal notranslate"><span class="pre">b_vv</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prior_predictive_fn</span> <span class="o">=</span> <span class="n">aesara</span><span class="o">.</span><span class="n">function</span><span class="p">((</span><span class="n">a_vv</span><span class="p">,</span> <span class="n">b_vv</span><span class="p">),</span> <span class="n">Y_rv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prior_predictive_fn</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prior_predictive_fn</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[17 20  6  0  4 20  1 19  9  4  7  1 16  7 19  6 15  0 18 19 17  0  7  6
  2  0 20  0 20 10  1  2 17 15  0  6 12 49  0  0  8 13 27 35 20 15 17 10
 16 18  3 13 17  7  2  6  1  0 14  0 15 12  1  8 12 18  6 41 33 17  8]
[ 0  0  0  8  0  0  1 17  0  0  2 17  5  0  0  0  0 13 19  0 18  0  7 22
  0  0 20  0 16 13 20  0  0  0  0 10  0  0 44  0  0  0  0  6  0 20  0  0
  0 15  8  0  0  5  0  0  0 19 12  6  0 19  0  0 20 20 24  9 46  0  0]
</pre></div>
</div>
</div>
</div>
<p>To sample from the posterior distribution of <code class="docutils literal notranslate"><span class="pre">theta_rv</span></code>, <code class="docutils literal notranslate"><span class="pre">a_rv</span></code> and <code class="docutils literal notranslate"><span class="pre">b_rv</span></code> we need to be able to compute the model’s joint log-density. In AePPL, we use <code class="docutils literal notranslate"><span class="pre">joint_logprob</span></code> to build the graph of the joint log-density from the model graph:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loglikelihood</span><span class="p">,</span> <span class="p">(</span><span class="n">y_vv</span><span class="p">,</span> <span class="n">theta_vv</span><span class="p">)</span> <span class="o">=</span> <span class="n">joint_logprob</span><span class="p">(</span><span class="n">Y_rv</span><span class="p">,</span> <span class="n">theta_rv</span><span class="p">)</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">logprior</span> <span class="o">+</span> <span class="n">loglikelihood</span>
</pre></div>
</div>
</div>
</div>
<p>However, the Beta distribution generates samples between 0 and 1 and gradient-based algorithms like NUTS work better on unbounded intervals. We can tell AePPL to apply a log-odds transformation to the Beta-distributed variable, and subsequently sample in the transformed space:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aeppl.transforms</span> <span class="kn">import</span> <span class="n">TransformValuesRewrite</span><span class="p">,</span> <span class="n">LogOddsTransform</span>

<span class="n">transforms_op</span> <span class="o">=</span> <span class="n">TransformValuesRewrite</span><span class="p">(</span>
     <span class="p">{</span><span class="n">theta_rv</span><span class="p">:</span> <span class="n">LogOddsTransform</span><span class="p">()}</span>
<span class="p">)</span>
<span class="n">loglikelihood</span><span class="p">,</span> <span class="p">(</span><span class="n">y_vv</span><span class="p">,</span> <span class="n">theta_vv</span><span class="p">)</span> <span class="o">=</span> <span class="n">joint_logprob</span><span class="p">(</span><span class="n">Y_rv</span><span class="p">,</span> <span class="n">theta_rv</span><span class="p">,</span> <span class="n">extra_rewrites</span><span class="o">=</span><span class="n">transforms_op</span><span class="p">)</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">logprior</span> <span class="o">+</span> <span class="n">loglikelihood</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>NUTS is not the best sampler for this model: the Beta distribution is the conjugate distribution of the Binomial. Marginalizing would lead to a faster sampler with less variance. <a class="reference external" href="https://github.com/aesara-devs/aemcmc">AeMCMC</a> (in alpha state) makes this kind of transformation automatically on Aesara models.</p>
</div>
<p>You can alway debug the <code class="docutils literal notranslate"><span class="pre">logprob</span></code> graph by printing it:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aesara</span><span class="o">.</span><span class="n">dprint</span><span class="p">(</span><span class="n">logprob</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elemwise{add,no_inplace} [id A]
 |Elemwise{mul,no_inplace} [id B]
 | |TensorConstant{-2.5} [id C]
 | |Elemwise{log,no_inplace} [id D]
 |   |Elemwise{add,no_inplace} [id E]
 |     |a [id F]
 |     |b [id G]
 |Sum{acc_dtype=float64} [id H]
   |MakeVector{dtype=&#39;float64&#39;} [id I]
     |Sum{acc_dtype=float64} [id J]
     | |Check{0 &lt;= p, p &lt;= 1} [id K]
     |   |Elemwise{switch,no_inplace} [id L]
     |   | |Elemwise{and_,no_inplace} [id M]
     |   | | |Elemwise{le,no_inplace} [id N]
     |   | | | |InplaceDimShuffle{x} [id O]
     |   | | | | |TensorConstant{0} [id P]
     |   | | | |&lt;TensorType(int64, (71,))&gt; [id Q]
     |   | | |Elemwise{le,no_inplace} [id R]
     |   | |   |&lt;TensorType(int64, (71,))&gt; [id Q]
     |   | |   |TensorConstant{[20 20 20 .. 47 24 14]} [id S]
     |   | |Elemwise{add,no_inplace} [id T]
     |   | | |Elemwise{add,no_inplace} [id U]
     |   | | | |Elemwise{sub,no_inplace} [id V]
     |   | | | | |Elemwise{sub,no_inplace} [id W]
     |   | | | | | |Elemwise{gammaln,no_inplace} [id X]
     |   | | | | | | |Elemwise{add,no_inplace} [id Y]
     |   | | | | | |   |TensorConstant{[20 20 20 .. 47 24 14]} [id S]
     |   | | | | | |   |InplaceDimShuffle{x} [id Z]
     |   | | | | | |     |TensorConstant{1} [id BA]
     |   | | | | | |Elemwise{gammaln,no_inplace} [id BB]
     |   | | | | |   |Elemwise{add,no_inplace} [id BC]
     |   | | | | |     |&lt;TensorType(int64, (71,))&gt; [id Q]
     |   | | | | |     |InplaceDimShuffle{x} [id BD]
     |   | | | | |       |TensorConstant{1} [id BE]
     |   | | | | |Elemwise{gammaln,no_inplace} [id BF]
     |   | | | |   |Elemwise{add,no_inplace} [id BG]
     |   | | | |     |Elemwise{sub,no_inplace} [id BH]
     |   | | | |     | |TensorConstant{[20 20 20 .. 47 24 14]} [id S]
     |   | | | |     | |&lt;TensorType(int64, (71,))&gt; [id Q]
     |   | | | |     |InplaceDimShuffle{x} [id BI]
     |   | | | |       |TensorConstant{1} [id BJ]
     |   | | | |Elemwise{switch,no_inplace} [id BK]
     |   | | |   |Elemwise{eq,no_inplace} [id BL]
     |   | | |   | |TransformedVariable [id BM]
     |   | | |   | | |Elemwise{sigmoid,no_inplace} [id BN]
     |   | | |   | | | |&lt;TensorType(float64, (71,))&gt; [id BO]
     |   | | |   | | |&lt;TensorType(float64, (71,))&gt; [id BO]
     |   | | |   | |InplaceDimShuffle{x} [id BP]
     |   | | |   |   |TensorConstant{0} [id BQ]
     |   | | |   |Elemwise{switch,no_inplace} [id BR]
     |   | | |   | |Elemwise{eq,no_inplace} [id BS]
     |   | | |   | | |&lt;TensorType(int64, (71,))&gt; [id Q]
     |   | | |   | | |InplaceDimShuffle{x} [id BT]
     |   | | |   | |   |TensorConstant{0} [id BU]
     |   | | |   | |InplaceDimShuffle{x} [id BV]
     |   | | |   | | |TensorConstant{0.0} [id BW]
     |   | | |   | |InplaceDimShuffle{x} [id BX]
     |   | | |   |   |TensorConstant{-inf} [id BY]
     |   | | |   |Elemwise{mul,no_inplace} [id BZ]
     |   | | |     |&lt;TensorType(int64, (71,))&gt; [id Q]
     |   | | |     |Elemwise{log,no_inplace} [id CA]
     |   | | |       |TransformedVariable [id BM]
     |   | | |Elemwise{switch,no_inplace} [id CB]
     |   | |   |Elemwise{eq,no_inplace} [id CC]
     |   | |   | |Elemwise{sub,no_inplace} [id CD]
     |   | |   | | |InplaceDimShuffle{x} [id CE]
     |   | |   | | | |TensorConstant{1.0} [id CF]
     |   | |   | | |TransformedVariable [id BM]
     |   | |   | |InplaceDimShuffle{x} [id CG]
     |   | |   |   |TensorConstant{0} [id CH]
     |   | |   |Elemwise{switch,no_inplace} [id CI]
     |   | |   | |Elemwise{eq,no_inplace} [id CJ]
     |   | |   | | |Elemwise{sub,no_inplace} [id CK]
     |   | |   | | | |TensorConstant{[20 20 20 .. 47 24 14]} [id S]
     |   | |   | | | |&lt;TensorType(int64, (71,))&gt; [id Q]
     |   | |   | | |InplaceDimShuffle{x} [id CL]
     |   | |   | |   |TensorConstant{0} [id CM]
     |   | |   | |InplaceDimShuffle{x} [id CN]
     |   | |   | | |TensorConstant{0.0} [id CO]
     |   | |   | |InplaceDimShuffle{x} [id CP]
     |   | |   |   |TensorConstant{-inf} [id CQ]
     |   | |   |Elemwise{mul,no_inplace} [id CR]
     |   | |     |Elemwise{sub,no_inplace} [id CK]
     |   | |     |Elemwise{log,no_inplace} [id CS]
     |   | |       |Elemwise{sub,no_inplace} [id CD]
     |   | |InplaceDimShuffle{x} [id CT]
     |   |   |TensorConstant{-inf} [id CU]
     |   |All [id CV]
     |   | |Elemwise{le,no_inplace} [id CW]
     |   |   |InplaceDimShuffle{x} [id CX]
     |   |   | |TensorConstant{0.0} [id CY]
     |   |   |TransformedVariable [id BM]
     |   |All [id CZ]
     |     |Elemwise{le,no_inplace} [id DA]
     |       |TransformedVariable [id BM]
     |       |InplaceDimShuffle{x} [id DB]
     |         |TensorConstant{1.0} [id DC]
     |Sum{acc_dtype=float64} [id DD]
       |Elemwise{add,no_inplace} [id DE]
         |Check{0 &lt;= value &lt;= 1, alpha &gt; 0, beta &gt; 0} [id DF]
         | |Elemwise{switch,no_inplace} [id DG]
         | | |Elemwise{and_,no_inplace} [id DH]
         | | | |Elemwise{ge,no_inplace} [id DI]
         | | | | |Elemwise{sigmoid,no_inplace} [id BN]
         | | | | |InplaceDimShuffle{x} [id DJ]
         | | | |   |TensorConstant{0.0} [id DK]
         | | | |Elemwise{le,no_inplace} [id DL]
         | | |   |Elemwise{sigmoid,no_inplace} [id BN]
         | | |   |InplaceDimShuffle{x} [id DM]
         | | |     |TensorConstant{1.0} [id DN]
         | | |Elemwise{sub,no_inplace} [id DO]
         | | | |Elemwise{add,no_inplace} [id DP]
         | | | | |Elemwise{switch,no_inplace} [id DQ]
         | | | | | |InplaceDimShuffle{x} [id DR]
         | | | | | | |Elemwise{eq,no_inplace} [id DS]
         | | | | | |   |a [id F]
         | | | | | |   |TensorConstant{1.0} [id DT]
         | | | | | |InplaceDimShuffle{x} [id DU]
         | | | | | | |TensorConstant{0.0} [id DV]
         | | | | | |Elemwise{mul,no_inplace} [id DW]
         | | | | |   |InplaceDimShuffle{x} [id DX]
         | | | | |   | |Elemwise{sub,no_inplace} [id DY]
         | | | | |   |   |a [id F]
         | | | | |   |   |TensorConstant{1.0} [id DZ]
         | | | | |   |Elemwise{log,no_inplace} [id EA]
         | | | | |     |Elemwise{sigmoid,no_inplace} [id BN]
         | | | | |Elemwise{switch,no_inplace} [id EB]
         | | | |   |InplaceDimShuffle{x} [id EC]
         | | | |   | |Elemwise{eq,no_inplace} [id ED]
         | | | |   |   |b [id G]
         | | | |   |   |TensorConstant{1.0} [id EE]
         | | | |   |InplaceDimShuffle{x} [id EF]
         | | | |   | |TensorConstant{0.0} [id EG]
         | | | |   |Elemwise{mul,no_inplace} [id EH]
         | | | |     |InplaceDimShuffle{x} [id EI]
         | | | |     | |Elemwise{sub,no_inplace} [id EJ]
         | | | |     |   |b [id G]
         | | | |     |   |TensorConstant{1.0} [id EK]
         | | | |     |Elemwise{log1p,no_inplace} [id EL]
         | | | |       |Elemwise{neg,no_inplace} [id EM]
         | | | |         |Elemwise{sigmoid,no_inplace} [id BN]
         | | | |InplaceDimShuffle{x} [id EN]
         | | |   |Elemwise{sub,no_inplace} [id EO]
         | | |     |Elemwise{add,no_inplace} [id EP]
         | | |     | |Elemwise{gammaln,no_inplace} [id EQ]
         | | |     | | |a [id F]
         | | |     | |Elemwise{gammaln,no_inplace} [id ER]
         | | |     |   |b [id G]
         | | |     |Elemwise{gammaln,no_inplace} [id ES]
         | | |       |Elemwise{add,no_inplace} [id ET]
         | | |         |a [id F]
         | | |         |b [id G]
         | | |InplaceDimShuffle{x} [id EU]
         | |   |TensorConstant{-inf} [id EV]
         | |All [id EW]
         | | |Elemwise{gt,no_inplace} [id EX]
         | |   |a [id F]
         | |   |TensorConstant{0.0} [id EY]
         | |All [id EZ]
         |   |Elemwise{gt,no_inplace} [id FA]
         |     |b [id G]
         |     |TensorConstant{0.0} [id FB]
         |Elemwise{add,no_inplace} [id FC]
           |Elemwise{log,no_inplace} [id FD]
           | |Elemwise{sigmoid,no_inplace} [id FE]
           |   |&lt;TensorType(float64, (71,))&gt; [id BO]
           |Elemwise{log1p,no_inplace} [id FF]
             |Elemwise{neg,no_inplace} [id FG]
               |Elemwise{sigmoid,no_inplace} [id FE]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipykernel.iostream.OutStream at 0x7fdf50f47ac0&gt;
</pre></div>
</div>
</div>
</div>
<p>To sample with Blackjax we will need to use Aesara’s JAX backend; <code class="docutils literal notranslate"><span class="pre">logprob_jax</span></code> defined below is a function that uses JAX operators, can be passed as an argument to <code class="docutils literal notranslate"><span class="pre">jax.jit</span></code> and <code class="docutils literal notranslate"><span class="pre">jax.grad</span></code>:</p>
<div class="cell tag_remove-stderr docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logdensity_fn</span> <span class="o">=</span> <span class="n">aesara</span><span class="o">.</span><span class="n">function</span><span class="p">((</span><span class="n">a_vv</span><span class="p">,</span> <span class="n">b_vv</span><span class="p">,</span> <span class="n">theta_vv</span><span class="p">,</span> <span class="n">y_vv</span><span class="p">),</span> <span class="n">logprob</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;JAX&quot;</span><span class="p">)</span>
<span class="n">logprob_jax</span> <span class="o">=</span> <span class="n">logdensity_fn</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">jit_fn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Let’s wrap this function to make our life simpler:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">logprob_jax</span></code> returns a tuple with a single element, but JAX can only differentiate scalar values and will complain.</p></li>
<li><p>We would like to work with dictionaries for the values of the variables;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Y_vv</span></code> is observed, so let’s fix its value.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logdensity_fn</span><span class="p">(</span><span class="n">position</span><span class="p">):</span>
    <span class="n">flat_position</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">logprob_jax</span><span class="p">(</span><span class="o">*</span><span class="n">flat_position</span><span class="p">,</span> <span class="n">n_of_positives</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s define the initial position from which we are going to start sampling:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax</span>

<span class="k">def</span> <span class="nf">init_param_fn</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    initialize a, b &amp; thetas</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key1</span><span class="p">,</span> <span class="n">key2</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span> <span class="p">(),</span> <span class="s2">&quot;float64&quot;</span><span class="p">,</span> <span class="n">minval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key2</span><span class="p">,</span> <span class="p">(),</span> <span class="s2">&quot;float64&quot;</span><span class="p">,</span> <span class="n">minval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
        <span class="s2">&quot;thetas&quot;</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="p">(</span><span class="n">n_rat_tumors</span><span class="p">,),</span> <span class="s2">&quot;float64&quot;</span><span class="p">,</span> <span class="n">minval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="p">}</span>

<span class="n">rng_key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">init_position</span> <span class="o">=</span> <span class="n">init_param_fn</span><span class="p">(</span><span class="n">rng_key</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And finally sample using Blackjax:</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inference_loop</span><span class="p">(</span>
    <span class="n">rng_key</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">initial_states</span><span class="p">,</span> <span class="n">num_samples</span>
<span class="p">):</span>
    <span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
    <span class="k">def</span> <span class="nf">one_step</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">):</span>
        <span class="n">states</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">states</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">states</span><span class="p">,</span> <span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">infos</span><span class="p">)</span>

    <span class="n">keys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">infos</span><span class="p">)</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">one_step</span><span class="p">,</span> <span class="n">initial_states</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">infos</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">blackjax</span>

<span class="n">n_adapt</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">adapt</span> <span class="o">=</span> <span class="n">blackjax</span><span class="o">.</span><span class="n">window_adaptation</span><span class="p">(</span><span class="n">blackjax</span><span class="o">.</span><span class="n">nuts</span><span class="p">,</span> <span class="n">logdensity_fn</span><span class="p">)</span>
<span class="n">state</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">adapt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">init_position</span><span class="p">,</span> <span class="n">n_adapt</span><span class="p">)</span>

<span class="n">states</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">inference_loop</span><span class="p">(</span>
    <span class="n">rng_key</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">n_samples</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Welcome to Blackjax!</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="howto_use_numpyro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Use with Numpyro models</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Blackjax developers<br/>
  
      &copy; Copyright 2023, The Blackjax developers.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>